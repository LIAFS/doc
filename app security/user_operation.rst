=========================== 
用户操作安全检测
=========================== 

密码机制
-----------------

* 检测内容：

 1.检测APP是否存在弱口令。

 2.检测APP在登录过程中是否有错误密码尝试次数限制，登录密码错误次数过多后是否采取保护措施。

 3.检测APP是否会记录登录信息，输入密码后切换会话，检查密码会话是否会残留密码。

 4.检测APP密码输入框的内容是否使用了不可区分的字符进行屏蔽。


* 检测方法：

 1.检测APP在注册、找回密码和修改密码过程是否可以设置弱口令。只要有其中一种情况满足，则被测APP允许使用弱口令。（一般情况下是使用123456进行测试）

 2.连续10次输入错误密码进行登录验证，查看连续10次错误验证之后被测账号是否会被暂时锁定；再次输入正确的用户名和密码是否可以成功登录。

 3.进入APP登录界面，输入密码后切换到后台在切换回来，检查密码会话是否会残留密码。

 4.进入APP登录界面，输入密码，查看密码输入框的内容是否使用了不可区分的字符进行屏蔽。

* 解决方案：

 1.建议强制使用长度为6位以上的字母加数字组合密码。

 2.连续多次错误密码登录验证后，锁定用户登录账号的时间至少为3小时。使用图形验证码进行防暴力破解。

 3.输入密码后切换到后台在切换回来，应该清空密码输入框中的内容。

 4.密码输入框的内容是应该使用“*”号等不可区分的字符进行屏蔽。



验证码机制
-----------------


* 检测内容：

 1.检测APP在注册、登录、修改密码、找回密码过程中使用图形验证码/短信验证码/邮箱验证码等机制。

 注：使用图形验证码机制可以防重放攻击和暴力破解，短信验证码/邮箱验证码可以进行用户身份校验。

 2.如果使用图形验证码，检测图形验证码来源（服务器或者本地）。

 3.检测APP使用的短信/邮箱验证码是有在超时或验证错误失效机制，以防止短信/邮箱验证码被暴力破解。



* 检测方法：

 1.进入APP注册、登录、修改密码、找回密码界面，查看是否使用图形验证码/短信验证码/邮箱验证码等机制。

 2.通过burpsuite抓包查看图形验证码的来源，是本地还是服务器端返回的。

 3.在需要短信/邮箱验证码的地方点击获取验证码，查看验证码形式（数字还是字母和数字组合）。

 4.获取验证码之后等待半小时或是1小时之后，输入验证码，看是否验证通过。

 5.连续20次获取验证码，查看是否都能获得到验证码。

 6.获取验证码之后输入错误验证码，看是否验证通过。

 7.不输入验证码，看是否验证通过。

 8.通过burpsuite抓包之后，删除验证码字段，看是否可以绕过验证。



* 解决方案：

 1.建议APP在注册、登录、修改密码、找回密码过程中使用图形验证码/短信验证码/邮箱验证码或是两者组合等机制。

 2.图形验证码应由服务器端生成并在服务器端做验证。

 3.短信/邮箱验证码验证码形式为数字形式，建议为6位，或是采取字母和数字组合形式。

 4.获取验证码超时时间为30分钟，超过30分钟失效。

 5.1天只可以获取5次验证码，之后不能收到验证码。

 6.输入错误的验证码，验证失败。

 7.不输入验证码，验证失败。

 8.对传输的参数进行完整性校验。


账户枚举
-----------------

 此内容同web检测，详细查看《web系统的安全和防攻击》文档。